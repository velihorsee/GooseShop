<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/" />
    
    <link rel="stylesheet" href="bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="global.css" /> @* Твоя база *@
    <link rel="stylesheet" href="app.css" />    @* Анімації *@
    <link rel="stylesheet" href="GooseShop.styles.css" /> @* Ізольовані стилі (Home.razor.css тут) *@
    
    <HeadOutlet @rendermode="InteractiveServer" />
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&family=Comfortaa:wght@700&family=Lobster&family=Montserrat:wght@900&display=swap" rel="stylesheet">

    @* Бібліотеки 3D та іконки *@
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r128/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r128/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r128/examples/js/geometries/DecalGeometry.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <script src="js/constructor.js"></script>
</head>

<body>
    <Routes @rendermode="InteractiveServer" />
    <script src="_framework/blazor.web.js"></script>


    <script>
        // 1. Відкриття/Закриття бокового меню
        window.toggleSidebar = () => {
            const sidebar = document.getElementById("sidebarMenu");
            if (sidebar) sidebar.classList.toggle("active");
        };

        // 2. Плавний скрол до каталогу
        window.scrollToElement = (elementId) => {
            const element = document.getElementById(elementId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        };

                window.initGooseRain = () => {
            const banner = document.querySelector('.z-hero-card');
            if (!banner) return;

            function createFallingGoose() {
                const goose = document.createElement('div');
                goose.className = 'falling-goose';
                goose.innerHTML = '🦢';

                // Початкові фізичні показники
                let curX = Math.random() * banner.offsetWidth;
                let curY = -50;
                let targetOffsetX = 0; // На скільки гусак відхилився через страх
                let targetOffsetY = 0;
                let speedY = 1.0 + Math.random() * 1.5; // Трішки повільніше для плавності
                let rotation = 0;

                goose.style.left = curX + 'px';
                goose.style.position = 'absolute';
                banner.appendChild(goose);

                const onMouseMove = (e) => {
                    const rect = banner.getBoundingClientRect();
                    const mouseX = e.clientX - rect.left;
                    const mouseY = e.clientY - rect.top;

                    // Розраховуємо дистанцію від курсору до поточної позиції гусака
                    const distX = (curX + targetOffsetX) - mouseX;
                    const distY = (curY + targetOffsetY) - mouseY;
                    const dist = Math.sqrt(distX * distX + distY * distY);

                    if (dist < 120) { // Радіус переляку
                        const angle = Math.atan2(distY, distX);
                        const force = (120 - dist) / 120; // Чим ближче мишка, тим сильніший поштовх

                        // Задаємо ціль для відскоку
                        targetOffsetX += Math.cos(angle) * 50 * force;
                        targetOffsetY += Math.sin(angle) * 50 * force;
                        rotation = angle * (180 / Math.PI) + 90; // Повертаємо гусака в бік втечі
                    }
                };

                banner.addEventListener('mousemove', onMouseMove);

                const update = () => {
                    // Падіння вниз
                    curY += speedY;

                    // ПЛАВНЕ ПОВЕРНЕННЯ (Lerp):
                    // Відхилення targetOffset завжди намагається повернутися до 0 (спокою)
                    targetOffsetX *= 0.92;
                    targetOffsetY *= 0.92;

                    // Фінальна позиція = базовий шлях + плавне відхилення
                    goose.style.top = (curY + targetOffsetY) + 'px';
                    goose.style.left = (curX + targetOffsetX) + 'px';
                    goose.style.transform = `rotate(${rotation}deg) scale(${1 + Math.abs(targetOffsetX)/100})`;

                    if (curY < banner.offsetHeight + 100) {
                        requestAnimationFrame(update);
                    } else {
                        banner.removeEventListener('mousemove', onMouseMove);
                        goose.remove();
                    }
                };
                update();
            }

            // Створюємо гусака кожні 2.5 секунди, щоб не захаращувати екран
            setInterval(createFallingGoose, 2500);
        };

        // 4. РОЗУМНИЙ ГУСАК-ГЕРОЙ (Тікає і повертається на місце)
            window.initSmartGoose = (elementId) => {
        const goose = document.getElementById(elementId);
        if (!goose) return;

        let currentX = 0, currentY = 0;
        let targetX = 0, targetY = 0;
        let isScared = false;

        document.addEventListener('mousemove', (e) => {
            const rect = goose.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;

            const distX = e.clientX - centerX;
            const distY = e.clientY - centerY;
            const distance = Math.sqrt(distX * distX + distY * distY);

            // Збільшуємо радіус, але робимо втечу плавною
            if (distance < 200) {
                isScared = true;
                const angle = Math.atan2(distY, distX);
                // Гусак тікає ВІД мишки
                targetX = -Math.cos(angle) * 150;
                targetY = -Math.sin(angle) * 150;
            } else {
                isScared = false;
                targetX = 0;
                targetY = 0;
            }
        });
                function animate() {
                // РІШЕННЯ ТРЯСКИ: Дуже плавне прямування до цілі (0.05 замість 0.15)
                const lerp = isScared ? 0.08 : 0.03;
                currentX += (targetX - currentX) * lerp;
                currentY += (targetY - currentY) * lerp;

                goose.style.transform = `translate(${currentX}px, ${currentY}px)`;
                requestAnimationFrame(animate);
            }
            animate();
        };
    </script>
</body>

<footer class="z-footer mt-auto">
    <div class="z-footer-divider"></div>

    <div class="container-fluid px-lg-5 py-5">
        <div class="row g-5 align-items-center">
            @* 1. ЛОГОТИП *@
            <div class="col-xl-4 col-md-12 text-center text-xl-start">
                <h2 class="z-footer-logo m-0">GOOSE<br><span class="outline-white">GANG</span></h2>
                <div class="z-badge-year shadow-pixel mt-3">EST. 2026</div>
            </div>

            @* 2. СОЦМЕРЕЖІ *@
            <div class="col-xl-4 col-md-6 text-center">
                <h4 class="text-white mb-4 fw-black">ПРИЄДНУЙСЯ</h4>
                <div class="d-flex gap-3 justify-content-center">
                    <a href="#" class="z-soc-big link-cyan"><i class="bi bi-telegram"></i></a>
                    <a href="#" class="z-soc-big link-green"><i class="bi bi-instagram"></i></a>
                    <a href="#" class="z-soc-big link-red"><i class="bi bi-tiktok"></i></a>
                </div>
            </div>

            @* 3. ПІДПИСКА ТА ДРОП *@
            <div class="col-xl-4 col-md-6 text-center text-xl-start">
                <div class="banner-content p-0">
                    <h4 class="text-white fw-black mb-2">НОВИЙ ДРОП</h4>
                    <p class="text-white-50 small mb-3">Підпишись, щоб не проґавити вихід</p>

                    @* ПІКСЕЛЬНЕ ПОЛЕ ВВОДУ ТА КНОПКА *@
                    <div class="z-subscription-box">
                        <h4 class="text-white fw-black mb-2">НОВИЙ ДРОП</h4>
                        <input type="email" class="z-input-pixel" placeholder="ТВІЙ EMAIL..." />
                        <button class="z-btn z-action-btn w-100">
                            ВЛІТАЙ У ДРОПИ <i class="bi bi-fire ms-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        @*НИЖНЯ ПАНЕЛЬ*@
        <div class="row mt-5 pt-4 border-top border-secondary border-opacity-25">
            <div class="col-md-6 text-center text-md-start">
                <span class="z-footer-copy">© 2026 NO MERCY FOR GOSLINGS.</span>
            </div>
            <div class="col-md-6 text-center text-md-end">
                <a href="#" class="z-footer-sublink me-4">PRIVACY</a>
                <a href="#" class="z-footer-sublink">TERMS</a>
            </div>
        </div>
    </div>
</footer>
</html>